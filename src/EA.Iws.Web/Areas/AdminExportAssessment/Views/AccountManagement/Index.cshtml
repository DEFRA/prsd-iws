@using EA.Iws.Core.NotificationAssessment
@using EA.Iws.Web.Areas.AdminExportAssessment.ViewModels.PaymentDetails
@using EA.Iws.Web.Areas.AdminExportAssessment.Views.AccountManagement
@using EnumHelper = EA.Prsd.Core.Helpers.EnumHelper
@model EA.Iws.Web.Areas.AdminExportAssessment.ViewModels.AccountManagement.AccountManagementViewModel

@{
    ViewBag.Title = @IndexResources.MainHeading;
}

<h1 class="heading-large">@IndexResources.MainHeading</h1>

<h2 class="heading-medium">@IndexResources.TotalHeading</h2>

<div class="heading-large">
    @Model.TotalBillable.ToString("C")
</div>

<hr>

<h2 class="heading-medium">@IndexResources.BalanceHeading</h2>

<div class="heading-large">
    @Model.Balance.ToString("C")
</div>

<hr>

<h2 class="heading-medium">@IndexResources.HistoryHeading</h2>

<div class="form-group">
    <table title=@IndexResources.HistoryHeading>
        <thead>
        <tr>
            <th>@IndexResources.TableHeaderTranaction</th>
            <th>@IndexResources.TableHeaderDate</th>
            <th>@IndexResources.TableHeaderAmount</th>
            <th>@IndexResources.TableHeaderType</th>
            <th>@IndexResources.TableHeaderReceipt</th>
            <th>@IndexResources.TableHeaderComments</th>
        </tr>
        </thead>
        <tbody>
        @{
            for (var i = 0; i < Model.TableData.Count(); i++)
            {
                var trans = (TransactionType)Model.TableData[i].Transaction;

                Enum type;
                if (trans == TransactionType.Refund)
                {
                    type = TransactionType.Refund;
                }
                else
                {
                    type = (PaymentMethods)Model.TableData[i].Type;
                }

                var comment = string.IsNullOrWhiteSpace(Model.TableData[i].Comments) ? "No" : "Yes";

                <tr>
                    <td>@trans</td>
                    <td>@Model.TableData[i].Date.ToString("dd/MM/yyyy")</td>
                    <td>@Model.TableData[i].Amount.ToString("C")</td>
                    <td>@EnumHelper.GetDescription(type)</td>
                    <td>@Model.TableData[i].Receipt</td>
                    <td>@comment</td>
                </tr>
            }
        }
        </tbody>
    </table>
</div>

<h2 class="heading-medium">@IndexResources.CommentSectionHeading</h2>

<div class="form-group">

    @for (var i = 0; i < Model.TableData.Count(); i++)
    {
        if (!string.IsNullOrWhiteSpace(Model.TableData[i].Comments))
        {
            var trans = (TransactionType)Model.TableData[i].Transaction;

            <details>
                <summary>
                    <span class="summary">
                        @trans
                        &nbsp;
                        @Model.TableData[i].Date.ToString("dd/MM/yyyy")
                    </span>
                </summary>

                <div class="panel-indent">
                    <p>@Model.TableData[i].Comments</p>
                </div>
            </details>
        }
    }
</div>

@model EA.Iws.Web.Areas.AdminExportAssessment.ViewModels.FinancialGuarantee.FinancialGuaranteeDecisionViewModel
@{
    ViewBag.Title = "Financial Guarantee Decision";
}

<h2 class="heading-large">Financial guarantee decision</h2>

@if (Model.IsApplicationCompleted)
{
    @Html.Partial("_Complete", Model)
}
else
{
    @Html.Partial("_Incomplete", Model)
}

@section scripts{
    <script>
        $(function () {
            var dropdownId = "#decision-select";
            var preLoad = true;

            var selectedDropdownSelector = dropdownId + " :selected";

            $(dropdownId).change(function () {
                var selected = $(selectedDropdownSelector).text();
                
                $(".guarantee-decision").addClass("js-hidden");

                if (!preLoad) {
                    $(".form-group").removeClass("error");
                    $("span.field-validation-error").empty();
                    var errorsSummary = $(".error-summary");
                    errorsSummary.empty();
                    errorsSummary.removeClass("error-summary");
                    errorsSummary.addClass("error-summary-valid");
                }

                $("#status" + selected).removeClass("js-hidden");

                if (selected === "" || selected === undefined || selected === null) {
                    $("#status").addClass("js-hidden");
                } else {
                    $("#status").removeClass("js-hidden");
                }

                preLoad = false;
            });

            var currentlySelected = $(selectedDropdownSelector).text();

            if (currentlySelected !== "") {
                $(dropdownId).trigger("change");
            }

            $("#rdoYes").change(function() {
                $("#referenceNumber").addClass("js-hidden");
                $("#blanketBondReference").removeClass("js-hidden");
            });

            $("#rdoNo").change(function () {
                $("#referenceNumber").removeClass("js-hidden");
                $("#blanketBondReference").addClass("js-hidden");
            });
        });
    </script>
}

@section menu {
    @Html.Action("ExportNavigation", "Menu", new { area = "Admin", section = ExportNavigationSection.Assessment })
}
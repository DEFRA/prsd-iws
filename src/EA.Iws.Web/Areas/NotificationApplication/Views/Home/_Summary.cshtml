@model EA.Iws.Web.Areas.NotificationApplication.ViewModels.NotificationApplication.SubmitSideBarViewModel
@using EA.Iws.Core.Notification;
@using EA.Iws.Core.NotificationAssessment;

@helper DisplayStatus(NotificationStatus status)
{
    string statusColour;
    switch (status)
    {
        case NotificationStatus.InAssessment:
        case NotificationStatus.ReadyToTransmit:
        case NotificationStatus.Transmitted:
        case NotificationStatus.DecisionRequiredBy:
        case NotificationStatus.Unlocked:
            statusColour = "s-orange";
            break;

        case NotificationStatus.Consented:
            statusColour = "s-green";
            break;

        case NotificationStatus.Objected:
        case NotificationStatus.Withdrawn:
        case NotificationStatus.ConsentWithdrawn:
            statusColour = "s-red";
            break;

        default:
            statusColour = "s-blue";
            break;
    }

    <span class="statusbox @statusColour">@EA.Prsd.Core.Helpers.EnumHelper.GetDisplayName(status)</span>
}

<section class="grid-row">
    <div class="noti-overview">
        <div class="column-half">
            <h2 class="heading-medium">@Model.NotificationNumber</h2>
            <h1 class="heading-large">Notification overview</h1>

            @if (Model.IsNotificationComplete && Model.Status == NotificationStatus.NotSubmitted)
            {
                @Html.ActionLink("Submit notification", "Disclaimer", "Submit", null, new { @class = "button" })
            }
            else if(!Model.IsNotificationComplete && Model.Status == NotificationStatus.NotSubmitted)
            {
                <a href="#" class="button" disabled="disabled">Submit notification</a>
                <div>You can submit this notification once you've completed all sections</div>
            }
        </div>

        <div class="column-half charge">
            
            <div class="status">
                <span>Overall Status</span>
                @DisplayStatus(Model.Status)
            </div>
            
            @if (Model.Charge > 0)
            {
                <div class="noti-charge">
                    <span>Notification<br />Charge</span>
                    <span class="price">&pound;@Model.Charge</span>
                </div>
            }

            <div class="noti-links">
                @if (Model.CompetentAuthority == CompetentAuthority.Scotland)
                {
                    @Html.ActionLink("Bank Guarantee template", "GenerateBankGuaranteeDocument", "Home", new { area = "FinancialGuarantee" }, null)
                    <br />
                    @Html.ActionLink("Parent Company template", "GenerateParentCompanyDocument", "Home", new { area = "FinancialGuarantee" }, null)
                }
                else
                {
                    @Html.ActionLink("Download financial guarantee", "GenerateFinancialGuaranteeDocument", "Home", new { area = "FinancialGuarantee", competentAuthority = Model.CompetentAuthority }, null)
                }
                <br />
                @if (Model.IsNotificationComplete)
                {
                    @Html.ActionLink("Download notification", "GenerateNotificationDocument", "Home", new { id = Model.NotificationId }, null)
                }
            </div>
        </div>
    </div>
</section>